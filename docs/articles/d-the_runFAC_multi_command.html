<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
<ol start="4" style="list-style-type: lower-alpha">
<li>The runFAC_multi() command: Running multiple FACs to explore parameter variation</li>
</ol> • FACavian</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="&lt;ol start=" style="list-style-type: lower-alpha">
</head>
<body>
<li>The runFAC_multi() command: Running multiple FACs to explore parameter variation</li>
" /&gt;

<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FACavian</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a-Introduction_FAC_demography.html">a) Introduction: Full Annual Cycle (FAC) Demography</a>
    </li>
    <li>
      <a href="../articles/b-overview.html">b) Overview of FACavian functionality</a>
    </li>
    <li>
      <a href="../articles/c-the_runFAC_command.html">c) The runFAC() command</a>
    </li>
    <li>
      <a href="../articles/d-the_runFAC_multi_command.html">d) The runFAC_multi() command: Running multiple FACs to explore parameter variation</a>
    </li>
    <li>
      <a href="../articles/e-make_figure_28_3.html">e) Making Runge and Mara Figure 28.3</a>
    </li>
    <li>
      <a href="../articles/f-make_figure_28_4.html">f) Making Runge and Mara Figure 28.4</a>
    </li>
    <li>
      <a href="../articles/g-make_figure_28_5.html">g) Making Runge and Mara Figure 28.5</a>
    </li>
    <li>
      <a href="../articles/h-make_figure_28_6.html">f) Making Runge and Mara Figure 28.6</a>
    </li>
    <li>
      <a href="../articles/p-tests.html">error_check_P_test</a>
    </li>
    <li>
      <a href="../articles/paper-notes.html">Misc notes</a>
    </li>
    <li>
      <a href="../articles/relevant_literature.html">Relevant literature</a>
    </li>
    <li>
      <a href="../articles/Runge_and_Marra_notes.html">The Full-annual cycle model of Runge &amp; Marra (2004)</a>
    </li>
    <li>
      <a href="../articles/Sherry_Holmes_notes.html">The Cannonical perspective on Full-annual cycle demography in migratory passerines</a>
    </li>
    <li>
      <a href="../articles/x-creating_a_package.html">w) Creating this package</a>
    </li>
    <li>
      <a href="../articles/y-building_a_package.html">z2) Building and rebuilding vignettes - orig</a>
    </li>
    <li>
      <a href="../articles/z-build_and_rebuild_package.html">z) Building and rebuilding vignettes</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1><ol start="4" style="list-style-type: lower-alpha">
<li>The runFAC_multi() command: Running multiple FACs to explore parameter variation</li>
</ol></h1>
                        <h4 class="author">Vignette Author</h4>
            
            <h4 class="date">2019-06-06</h4>
      
      
      <div class="hidden name"><code>d-the_runFAC_multi_command.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>A major motivation for studying full-annual cycle population dynamics is to determine when during the annual cycle population limitation occurs. For example, a perennial question is whether habitat loss on the breeding grounds or wintering grounds is more important for population dynamics (CITE).</p>
<p>For standard density-independent population models, such as matrix models or integral projection models, there are analytica solutions that allow you to compare the importance of all vital rates for population growth. These methods include sensitivity and elasticity analyses, as well as Life Table Response Experiments (LTRE). To carry out these analyses all that is required is the parameterized model and a compute program (such as R) that can do mathematical functions such as determining the eigen values of matrices.</p>
<p>Complex density-dependent models such as the one developed by Runge and Marra (2004) can not be assayed directly using analytical methods. Models such as this must be run repeatedly with different parameter values and the output of the model compared as conditions change. This requires running many indepdent models to equilibrium, each with slightly diffrent paramter values, storing the relevant output, and comparing the output. Runge and Marra (2004) graphically explored how varying breeding season and winter carrying capacity impacted breeding ground population size (Figures 28.3 in the original paper), how breeding ground carrying capacity impacted breeding and winter population structure (28.4), and male dominance impacted the sex ratio (Figure 28.5), and the strength of carry-over effects impacted poulation size (Figure 28.6).</p>
<p>The FACavian package implements and extends the analyses carried out by Runge and Marra (2004) using the function runFAC_multi(). This function allows you to run multiple FAC models each with different parameter values. The following vignette demonstrates the basic functionality of runFAC_multi(). Each of the analyses in Runge and Marra (2004) are then coverged in a seperate vignette.</p>
</div>
<div id="preliminaries" class="section level2">
<h2 class="hasAnchor">
<a href="#preliminaries" class="anchor"></a>Preliminaries</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(FACavian)</code></pre></div>
</div>
<div id="the-runfac_multi-function" class="section level2">
<h2 class="hasAnchor">
<a href="#the-runfac_multi-function" class="anchor"></a>The runFAC_multi() function</h2>
<p>runFAC_multi(param.grid = param_grid(), Ninit = c(10, 0, 10, 0), remakeFigure = NA, use.IBM = F, verbose = F, eq.tol = 6, …)</p>
</div>
<div id="recreate-figures-in-the-original-paper" class="section level2">
<h2 class="hasAnchor">
<a href="#recreate-figures-in-the-original-paper" class="anchor"></a>Recreate figures in the original paper</h2>
<div id="figure-28-3-3d-surface" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-28-3-3d-surface" class="anchor"></a>Figure 28.3: 3D surface</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">F28_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw"><a href="../reference/runFAC_multi.html">runFAC_multi</a></span>(<span class="dt">eq.tol =</span> <span class="dv">2</span>, 
                      <span class="dt">verbose =</span> F)
<span class="co">#&gt; The dimension of the fully expanded dataframe is: </span>
<span class="co">#&gt; 100 by 30</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 21 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 21 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 21 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 21 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 21 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 21 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 21 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 21 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 21 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 21 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 62 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 44 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 44 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 44 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 44 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 44 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 44 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 44 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 44 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 44 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 62 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 54 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 54 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 54 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 54 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 54 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 54 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 54 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 54 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 54 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 62 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 59 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 61 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 61 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 61 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 61 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 61 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 61 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 61 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 61 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 62 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 62 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 64 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 65 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 65 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 65 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 65 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 65 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 65 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 65 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 62 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 70 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 66 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 69 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 69 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 69 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 69 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 69 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 69 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 69 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 62 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 83 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 70 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 71 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 72 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 72 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 72 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 72 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 72 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 72 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 62 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 83 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 72 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 72 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 74 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 74 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 74 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 74 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 74 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 74 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 62 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 83 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 73 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 74 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 75 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 76 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 76 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 76 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 76 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 76 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 62 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 83 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 76 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 76 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 76 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 78 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 78 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 78 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 78 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 78 iterations</span></code></pre></div>
<p>runFAC_multi produces a list with two elements.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">is</span>(F28_<span class="dv">3</span>)
<span class="co">#&gt; [1] "list"   "vector"</span>
<span class="kw">length</span>(F28_<span class="dv">3</span>)
<span class="co">#&gt; [1] 2</span></code></pre></div>
<p>One holds the output for the original model of Runge and Marra (rmFAC; multiFAC.out.df.RM), while the holds the output for from a model with individual-based submodels (ibFAC; multiFAC.out.df.IB:’data.frame). We’ll focus on rmFAC.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(F28_<span class="dv">3</span>, <span class="dv">1</span>)
<span class="co">#&gt; List of 2</span>
<span class="co">#&gt;  $ multiFAC.out.df.RM:'data.frame':  100 obs. of  23 variables:</span>
<span class="co">#&gt;  $ multiFAC.out.df.IB:'data.frame':  100 obs. of  11 variables:</span></code></pre></div>
<p>The rmFAC element is dataframe.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">is</span>(F28_<span class="dv">3</span><span class="op">$</span>multiFAC.out.df.RM)
<span class="co">#&gt; [1] "data.frame" "list"       "oldClass"   "vector"</span></code></pre></div>
<p>This dataframe. contains information on the output dozens of individual FAC models run to equilibrium so it very large</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(F28_<span class="dv">3</span><span class="op">$</span>multiFAC.out.df.RM)
<span class="co">#&gt; [1] 100  23</span></code></pre></div>
<p>There are 23 rows for various output such as the population sizes and sex ratios. There are 100 rows.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(F28_<span class="dv">3</span><span class="op">$</span>multiFAC.out.df.RM,<span class="dv">1</span>)
<span class="co">#&gt; 'data.frame':    100 obs. of  23 variables:</span>
<span class="co">#&gt;  $ B.mc          : num  1 2.7 2.7 2.7 2.7 ...</span>
<span class="co">#&gt;  $ B.mk          : num  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;  $ B.md          : num  0.0415 0 0 0 0 ...</span>
<span class="co">#&gt;  $ B.fc          : num  0.95 2.6 2.6 2.6 2.6 ...</span>
<span class="co">#&gt;  $ B.fk          : num  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;  $ W.mg          : num  0.839 0.838 0.838 0.838 0.838 ...</span>
<span class="co">#&gt;  $ W.mp          : num  0.631 3.086 3.086 3.086 3.086 ...</span>
<span class="co">#&gt;  $ W.fg          : num  0.161 0.162 0.162 0.162 0.162 ...</span>
<span class="co">#&gt;  $ W.fp          : num  1.25 3.68 3.68 3.68 3.68 ...</span>
<span class="co">#&gt;  $ error1        : logi  NA NA NA NA NA NA ...</span>
<span class="co">#&gt;  $ error2        : logi  NA NA NA NA NA NA ...</span>
<span class="co">#&gt;  $ gamma.i       : num  5 5 5 5 5 5 5 5 5 5 ...</span>
<span class="co">#&gt;  $ c.i           : num  1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ K.bc.i        : num  1 112 223 334 445 556 667 778 889 1000 ...</span>
<span class="co">#&gt;  $ K.wg.i        : num  1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ B.m.tot       : num  1.04 2.7 2.7 2.7 2.7 ...</span>
<span class="co">#&gt;  $ B.m.tot.no.d  : num  1 2.7 2.7 2.7 2.7 ...</span>
<span class="co">#&gt;  $ B.f.tot       : num  0.95 2.6 2.6 2.6 2.6 ...</span>
<span class="co">#&gt;  $ sex.ratio     : num  1.1 1.04 1.04 1.04 1.04 ...</span>
<span class="co">#&gt;  $ sex.ratio.no.d: num  1.05 1.04 1.04 1.04 1.04 ...</span>
<span class="co">#&gt;  $ B.tot         : num  1.99 5.3 5.3 5.3 5.3 ...</span>
<span class="co">#&gt;  $ B.tot.no.d    : num  1.95 5.3 5.3 5.3 5.3 ...</span>
<span class="co">#&gt;  $ variable      : int  1 2 3 4 5 6 7 8 9 10 ...</span></code></pre></div>
<p>Each rows is a single run of the model. runFAC_multi() is designed to run the model over multiple combinations of parametrs. A principle output is a 3D surface plot where the x and y axes are two parameters varied between runs of the model and the z (vertical axis) is a state of interest when the model is at equilibrium, such as the equilibirum summer population size.</p>
<p>Plot the 3D surface.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))
<span class="kw"><a href="../reference/plot_Fig28_3.html">plot_Fig28_3</a></span>(F28_<span class="dv">3</span><span class="op">$</span>multiFAC.out.df.RM)</code></pre></div>
<p><img src="d-the_runFAC_multi_command_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
<div id="figure-28-4" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-28-4" class="anchor"></a>Figure 28.4</h3>
<div id="create-parameters" class="section level4">
<h4 class="hasAnchor">
<a href="#create-parameters" class="anchor"></a>Create parameters</h4>
</div>
<div id="create-the-intial-range-of-the-parameters" class="section level4">
<h4 class="hasAnchor">
<a href="#create-the-intial-range-of-the-parameters" class="anchor"></a>Create the intial range of the parameters</h4>
<p>The param_ranges() function can be used to create ranges (minimum and maxiumum) of parameters that can then be subsequently explored using runFAC_multi(). This is the first step, followed by generating sequences of numbers between the min and the max. param_ranges() is set up to take as arguements different scenarios (scenario = … ) or figures (figure = …) defined by Runge and Marra and to produce the combinations of parameters used in that paper. In general one or two parameters are varied and all the others are kept constant.</p>
<p>We can set up the parameters for Figures 28.3 and 28.4 like this</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">F28.<span class="fl">3.</span>range &lt;-<span class="st"> </span><span class="kw"><a href="../reference/param_ranges.html">param_ranges</a></span>(<span class="dt">figure =</span> <span class="fl">28.3</span>)
F28.<span class="fl">4.</span>range &lt;-<span class="st"> </span><span class="kw"><a href="../reference/param_ranges.html">param_ranges</a></span>(<span class="dt">figure =</span> <span class="fl">28.4</span>)</code></pre></div>
<p>In this figure K.bc was varied from 100 to 600 and all other parameters kept constant.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(F28.<span class="fl">4.</span>range)
<span class="co">#&gt;          min   max</span>
<span class="co">#&gt; gamma  5e+00 5e+00</span>
<span class="co">#&gt; co.    1e+00 1e+00</span>
<span class="co">#&gt; K.bc   1e+00 6e+02</span>
<span class="co">#&gt; K.bk   1e+04 1e+04</span>
<span class="co">#&gt; K.wg   9e+02 9e+02</span>
<span class="co">#&gt; S.w.mg 8e-01 8e-01</span></code></pre></div>
</div>
<div id="turn-any-varying-parameters-into-sequence" class="section level4">
<h4 class="hasAnchor">
<a href="#turn-any-varying-parameters-into-sequence" class="anchor"></a>Turn any varying parameters into sequence</h4>
<p>Once the minimum and maxium are set the actual sequence of numbers can be made. This</p>
<p>For Figure 28.4 breding ground carrying capacity is varied from 100 to 600, so we want a vector of numbers, say 100, 200, 300, 400, 500, 600.</p>
<p>For Figure 28.3 breding ground carrying capacity is varied from 1 to 1000, and also winter carrying capacity is varied from 1 to 100.</p>
<p>We make a list the has all the parameters we need</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">F28.<span class="fl">3.</span>seq &lt;-<span class="st"> </span><span class="kw"><a href="../reference/param_seqs.html">param_seqs</a></span>(F28.<span class="fl">3.</span>range)
F28.<span class="fl">4.</span>seq &lt;-<span class="st"> </span><span class="kw"><a href="../reference/param_seqs.html">param_seqs</a></span>(F28.<span class="fl">4.</span>range)</code></pre></div>
<p>This is a list</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">is</span>(F28.<span class="fl">4.</span>seq)
<span class="co">#&gt; [1] "list"   "vector"</span></code></pre></div>
<p>There is one element for each input parameter</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(F28.<span class="fl">4.</span>seq)
<span class="co">#&gt; [1] 30</span></code></pre></div>
<p>If a parameter does not need to be varied a single value appears in its slot. Otherwise a vector. For figure 28.4 there is just one parameter that varies</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(F28.<span class="fl">4.</span>seq)
<span class="co">#&gt; $gamma</span>
<span class="co">#&gt; [1] 5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $co.</span>
<span class="co">#&gt; [1] 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $K.bc</span>
<span class="co">#&gt;  [1]   1.00000  67.55556 134.11111 200.66667 267.22222 333.77778 400.33333</span>
<span class="co">#&gt;  [8] 466.88889 533.44444 600.00000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $K.bk</span>
<span class="co">#&gt; [1] 10000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $K.wg</span>
<span class="co">#&gt; [1] 900</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $S.w.mg</span>
<span class="co">#&gt; [1] 0.8</span></code></pre></div>
<p>For figure 28.3 there are two</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(F28.<span class="fl">3.</span>seq)
<span class="co">#&gt; $gamma</span>
<span class="co">#&gt; [1] 5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $co.</span>
<span class="co">#&gt; [1] 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $K.bc</span>
<span class="co">#&gt;  [1]    1  112  223  334  445  556  667  778  889 1000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $K.bk</span>
<span class="co">#&gt; [1] 10000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $K.wg</span>
<span class="co">#&gt;  [1]    1  112  223  334  445  556  667  778  889 1000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $S.w.mg</span>
<span class="co">#&gt; [1] 0.8</span></code></pre></div>
</div>
<div id="expand-parameters-into-a-grid" class="section level4">
<h4 class="hasAnchor">
<a href="#expand-parameters-into-a-grid" class="anchor"></a>Expand parameters into a grid</h4>
<p>Once the parameters have been defined a set of all possible parameter combinations needs to be created. This is essentially a grid of all possible value. (The shape isn’t a square grid, but takes its name from the use of R’s expand.grid function)</p>
<p>For figure 28.4 only one parameter is varied.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">F28.<span class="fl">4.</span>grid &lt;-<span class="st"> </span><span class="kw"><a href="../reference/param_grid.html">param_grid</a></span>(<span class="dt">param.seqs =</span> F28.<span class="fl">4.</span>seq)
<span class="co">#&gt; The dimension of the fully expanded dataframe is: </span>
<span class="co">#&gt; 10 by 30</span></code></pre></div>
<p>Figure 28.3 is much larger because two parameters are varied.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">F28.<span class="fl">3.</span>grid &lt;-<span class="st"> </span><span class="kw"><a href="../reference/param_grid.html">param_grid</a></span>(<span class="dt">param.seqs =</span> F28.<span class="fl">3.</span>seq)
<span class="co">#&gt; The dimension of the fully expanded dataframe is: </span>
<span class="co">#&gt; 100 by 30</span></code></pre></div>
<p>The output is a dataframe</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">is</span>(F28.<span class="fl">4.</span>grid)
<span class="co">#&gt; [1] "data.frame" "list"       "oldClass"   "vector"</span></code></pre></div>
<p>Each row of the dataframe contains all the parameters needed for a single run of the model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(F28.<span class="fl">4.</span>grid)[,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]
<span class="co">#&gt;   gamma co.      K.bc  K.bk K.wg S.w.mg S.w.mp S.w.fg S.w.fp S.m.mg</span>
<span class="co">#&gt; 1     5   1   1.00000 10000  900    0.8    0.8    0.8    0.8    0.9</span>
<span class="co">#&gt; 2     5   1  67.55556 10000  900    0.8    0.8    0.8    0.8    0.9</span>
<span class="co">#&gt; 3     5   1 134.11111 10000  900    0.8    0.8    0.8    0.8    0.9</span>
<span class="co">#&gt; 4     5   1 200.66667 10000  900    0.8    0.8    0.8    0.8    0.9</span>
<span class="co">#&gt; 5     5   1 267.22222 10000  900    0.8    0.8    0.8    0.8    0.9</span>
<span class="co">#&gt; 6     5   1 333.77778 10000  900    0.8    0.8    0.8    0.8    0.9</span></code></pre></div>
<p>Each row of data will be fed in the runFAC() function and the model run until an equilibirum is reached.</p>
</div>
<div id="run-multiple-facs-accross-the-parameters" class="section level4">
<h4 class="hasAnchor">
<a href="#run-multiple-facs-accross-the-parameters" class="anchor"></a>Run multiple FACs accross the parameters</h4>
<p>We can run the grid to equilibrium with runFAC_multi().</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">F28.<span class="fl">4.</span>FAC &lt;-<span class="st"> </span><span class="kw"><a href="../reference/runFAC_multi.html">runFAC_multi</a></span>(<span class="dt">param.grid =</span> F28.<span class="fl">4.</span>grid,
                             <span class="dt">verbose =</span> F, 
                             <span class="dt">eq.tol =</span><span class="dv">6</span>,
                             <span class="dt">Ninit =</span> <span class="kw">c</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">100</span>, <span class="dv">0</span>))
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 273 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 200 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 211 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 82 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 76 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 79 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 83 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 137 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 122 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 122 iterations</span></code></pre></div>
</div>
</div>
<div id="plot-figure-28-4" class="section level3">
<h3 class="hasAnchor">
<a href="#plot-figure-28-4" class="anchor"></a>Plot Figure 28.4</h3>
<p>Different kinds of figures require different set up and so there are specific functions for each figure. Figure 28.3 is made with function plot_Fig28_3(). Figure 28.4 has its own function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plot_Fig28_4.html">plot_Fig28_4</a></span>(F28.<span class="fl">4.</span>FAC<span class="op">$</span>multiFAC.out.df.RM)</code></pre></div>
<p><img src="d-the_runFAC_multi_command_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#preliminaries">Preliminaries</a></li>
      <li><a href="#the-runfac_multi-function">The runFAC_multi() function</a></li>
      <li><a href="#recreate-figures-in-the-original-paper">Recreate figures in the original paper</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Brouwer Nathan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  
</body>
</html>
