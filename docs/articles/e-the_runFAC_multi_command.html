<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>e) The runFAC_multi() command: Running multiple FACs to explore the effects varying parameters • redstart</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="e) The runFAC_multi() command: Running multiple FACs to explore the effects varying parameters">
<meta property="og:description" content="redstart">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">redstart</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a-Bio_Intro-FAC_demography.html">a) Biology Introduction: Full Annual Cycle (FAC) Demography</a>
    </li>
    <li>
      <a href="../articles/b-model_intro-RM_FAC_model.html">b) Model Introduction: The Runge &amp; Marra (2005) Full Annual Cycle Model</a>
    </li>
    <li>
      <a href="../articles/c-software_intro_rmFAC.html">c) Software introduction: The redstart package</a>
    </li>
    <li>
      <a href="../articles/d-the_runFAC_command.html">d) The runFAC() command</a>
    </li>
    <li>
      <a href="../articles/e-the_runFAC_multi_command.html">e) The runFAC_multi() command: Running multiple FACs to explore the effects varying parameters</a>
    </li>
    <li>
      <a href="../articles/f-make_figure_28_3.html">e) Making Runge and Mara Figure 28.3</a>
    </li>
    <li>
      <a href="../articles/g-make_figure_28_4.html">f) Making Runge and Mara Figure 28.4: variation in male territoriality</a>
    </li>
    <li>
      <a href="../articles/h-make_figure_28_5.html">g) Making Runge and Mara Figure 28.5</a>
    </li>
    <li>
      <a href="../articles/i-make_figure_28_6.html">f) Making Runge and Mara Figure 28.6</a>
    </li>
    <li>
      <a href="../articles/p-software_checks.html">p) Software checks</a>
    </li>
    <li>
      <a href="../articles/v-Sherry_Holmes_notes.html">v) Sherry-Holmes Notes</a>
    </li>
    <li>
      <a href="../articles/w-annotated_bib.html">w) Annotated bibliography</a>
    </li>
    <li>
      <a href="../articles/x-creating_a_package.html">w) Creating this package</a>
    </li>
    <li>
      <a href="../articles/y-building_a_package.html">z) Building and rebuilding vignettes - orig</a>
    </li>
    <li>
      <a href="../articles/z-MANUSCRIPT.html">(RE) Modeling Seasonal Interactions in the Population Dynamics of Migratory Birds</a>
    </li>
    <li>
      <a href="../articles/z-TODO.html">TO DO</a>
    </li>
    <li>
      <a href="../articles/z-build_and_rebuild_package.html">z) Building and rebuilding vignettes</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="e-the_runFAC_multi_command_files/header-attrs-2.11/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>e) The runFAC_multi() command: Running multiple FACs to explore the effects varying parameters</h1>
                        <h4 class="author">Nathan L. Brouwer</h4>
            
            <h4 class="date">2022-03-07</h4>
      
      
      <div class="hidden name"><code>e-the_runFAC_multi_command.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>A major motivation for studying full-annual cycle population dynamics is to determine when during the annual cycle population limitation occurs. For example, a perennial question is whether habitat loss on the breeding grounds or wintering grounds is more important for population dynamics (TODO: CITE).</p>
<p>For standard density-independent (di) population models , such as matrix models (TODO: CITE) or integral projection models (TODO: CITE), there are analytical solutions that allow you to compare the importance of vital rates for population growth. These methods include sensitivity and elasticity analyses (TODO: CITE), as well as Life Table Response Experiments (LTRE; (TODO: CITE)). To carry out these analyses all that is required is the parameterized model and a program (such as R) that can do mathematical functions such as determinie what are known as the the eigenvalues of matrices. For an introduction to matrix models and eigenanlysis in R see … (TODO: CITE). For a general introduction to matrix models with worked examples see Morris and Doak 200x and the R package based on it popbio (TODO: CITE).</p>
<p>Density-dependent (dd) models are analyzed very differently than density-independent models (TODO: CITE). The add complexities of building and anlysing dd has made them relatively rare. Moreover, most dd models use functions similar to the classic logistic growth curve ((TODO: add figure of curve) to model have vital rates change as a function of density. For birds the primary form of density dependence is suspected to be due to the constrains imposed by a limited number of territories. This has been called <strong>site-dependence</strong> in the bird literature (TODo: cite Rodenhouse etc) and corresponds with what is called <strong>celing model</strong> of density depencence elsewhere (cite Morris and Doak, etc).</p>
<p>Complex dd models such as the one developed by Runge and Marra (2004) can not be assayed directly using analytical methods. Models such as this must be run repeatedly with different parameter values and the output of the model compared as conditions change. This requires running many indepdent models to equilibrium, each with slightly diffrent paramter values, storing the relevant output, and comparing the output. Runge and Marra (2004) graphically explored how</p>
<ol style="list-style-type: decimal">
<li>varying breeding season and winter carrying capacity impacted breeding ground population size (Figures 28.3in the original paper),</li>
<li>how breeding ground carrying capacity impacted breeding and winter population structure (28.4), and male dominance impacted the sex ratio (Figure 28.5), and</li>
<li>the strength of carry-over effects impacted population size (Figure 28.6).</li>
</ol>
<p>The redstart package implements and extends the analyses carried out by Runge and Marra (2004) using the function <strong>runFAC_multi()</strong>. This function allows you to run multiple FAC models each with different parameter values. The following vignette demonstrates the basic functionality of runFAC_multi(). Each of the analyses in Runge and Marra (2004) are then coverged in a seperate vignette.</p>
</div>
<div id="preliminaries" class="section level2">
<h2 class="hasAnchor">
<a href="#preliminaries" class="anchor"></a>Preliminaries</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">redstart</span><span class="op">)</span></code></pre></div>
</div>
<div id="the-runfac_multi-function" class="section level2">
<h2 class="hasAnchor">
<a href="#the-runfac_multi-function" class="anchor"></a>The runFAC_multi() function</h2>
<p>runFAC_multi(param.grid = param_grid(), Ninit = c(10, 0, 10, 0), remakeFigure = NA, use.IBM = F, verbose = F, eq.tol = 6, …)</p>
</div>
<div id="recreate-figures-in-the-original-paper" class="section level2">
<h2 class="hasAnchor">
<a href="#recreate-figures-in-the-original-paper" class="anchor"></a>Recreate figures in the original paper</h2>
<div id="figure-28-3-3d-surface" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-28-3-3d-surface" class="anchor"></a>Figure 28.3: 3D surface</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">F28_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runFAC_multi.html">runFAC_multi</a></span><span class="op">(</span>eq.tol <span class="op">=</span> <span class="fl">2</span>, 
                      verbose <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>
<span class="co">#&gt; The dimension of the fully expanded dataframe is: </span>
<span class="co">#&gt; 100 by 30</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 21 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 21 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 21 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 21 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 21 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 21 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 21 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 21 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 21 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 24 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 44 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 44 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 44 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 44 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 44 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 44 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 44 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 44 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 44 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 24 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 54 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 54 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 54 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 54 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 54 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 54 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 54 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 54 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 54 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 24 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 56 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 61 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 61 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 61 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 61 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 61 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 61 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 61 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 61 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 24 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 58 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 64 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 65 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 65 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 65 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 65 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 65 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 65 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 65 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 24 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 58 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 66 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 69 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 69 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 69 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 69 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 69 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 69 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 69 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 24 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 58 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 67 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 71 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 72 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 72 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 72 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 72 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 72 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 72 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 24 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 58 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 69 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 72 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 74 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 74 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 74 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 74 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 74 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 74 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 24 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 58 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 69 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 73 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 75 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 76 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 76 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 76 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 76 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 76 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 24 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 58 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 69 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 74 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 76 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 78 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 78 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 78 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 78 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 78 iterations</span></code></pre></div>
<p>runFAC_multi produces a list with two elements.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">is</span><span class="op">(</span><span class="va">F28_3</span><span class="op">)</span>
<span class="co">#&gt; [1] "list"   "vector"</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">F28_3</span><span class="op">)</span>
<span class="co">#&gt; [1] 2</span></code></pre></div>
<p>One holds the output for the original model of Runge and Marra (rmFAC; multiFAC.out.df.RM), while the other holds the output for from a model with individual-based submodels (ibFAC; multiFAC.out.df.IB:’data.frame). We’ll focus on rmFAC.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">F28_3</span>, <span class="fl">1</span><span class="op">)</span>
<span class="co">#&gt; List of 2</span>
<span class="co">#&gt;  $ multiFAC.out.df.RM:'data.frame':  100 obs. of  53 variables:</span>
<span class="co">#&gt;  $ multiFAC.out.df.IB:'data.frame':  100 obs. of  41 variables:</span></code></pre></div>
<p>The rmFAC element is a dataframe.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">is</span><span class="op">(</span><span class="va">F28_3</span><span class="op">$</span><span class="va">multiFAC.out.df.RM</span><span class="op">)</span>
<span class="co">#&gt; [1] "data.frame" "list"       "oldClass"   "vector"</span></code></pre></div>
<p>This dataframe contains information on the output of dozens of individual runs of the FAC model to equilibrium, so it very large</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">F28_3</span><span class="op">$</span><span class="va">multiFAC.out.df.RM</span><span class="op">)</span>
<span class="co">#&gt; [1] 100  53</span></code></pre></div>
<p>There are 23 rows for various output such as the population sizes and sex ratios. There are 100 rows.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">F28_3</span><span class="op">$</span><span class="va">multiFAC.out.df.RM</span>,<span class="fl">1</span><span class="op">)</span>
<span class="co">#&gt; 'data.frame':    100 obs. of  53 variables:</span>
<span class="co">#&gt;  $ B.mc          : num  0.371 2.702 2.702 2.702 2.702 ...</span>
<span class="co">#&gt;  $ B.mk          : num  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;  $ B.md          : num  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;  $ B.fc          : num  0.341 2.597 2.597 2.597 2.597 ...</span>
<span class="co">#&gt;  $ B.fk          : num  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;  $ W.mg          : num  0.407 0.838 0.838 0.838 0.838 ...</span>
<span class="co">#&gt;  $ W.mp          : num  0.121 3.086 3.086 3.086 3.086 ...</span>
<span class="co">#&gt;  $ W.fg          : num  0.157 0.162 0.162 0.162 0.162 ...</span>
<span class="co">#&gt;  $ W.fp          : num  0.348 3.682 3.682 3.682 3.682 ...</span>
<span class="co">#&gt;  $ P.cgg         : num  0.337 0.045 0.045 0.045 0.045 ...</span>
<span class="co">#&gt;  $ P.cgp         : num  0.52 0.187 0.187 0.187 0.187 ...</span>
<span class="co">#&gt;  $ P.cpg         : num  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;  $ P.cpp         : num  0.142 0.768 0.768 0.768 0.768 ...</span>
<span class="co">#&gt;  $ P.kgg         : num  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;  $ P.kgp         : num  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;  $ P.kpg         : num  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;  $ P.kpp         : num  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;  $ y.mc          : num  0.246 1.87 1.87 1.87 1.87 ...</span>
<span class="co">#&gt;  $ y.mk          : num  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;  $ y.fc          : num  0.246 1.87 1.87 1.87 1.87 ...</span>
<span class="co">#&gt;  $ y.fk          : num  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;  $ A.G.mc        : logi  NA NA NA NA NA NA ...</span>
<span class="co">#&gt;  $ A.G.mk        : logi  NA NA NA NA NA NA ...</span>
<span class="co">#&gt;  $ A.G.md        : logi  NA NA NA NA NA NA ...</span>
<span class="co">#&gt;  $ A.G.y.mc      : logi  NA NA NA NA NA NA ...</span>
<span class="co">#&gt;  $ A.G.y.mk      : logi  NA NA NA NA NA NA ...</span>
<span class="co">#&gt;  $ A.G.fc        : logi  NA NA NA NA NA NA ...</span>
<span class="co">#&gt;  $ A.G.fk        : logi  NA NA NA NA NA NA ...</span>
<span class="co">#&gt;  $ A.G.y.fc      : logi  NA NA NA NA NA NA ...</span>
<span class="co">#&gt;  $ A.G.y.fk      : logi  NA NA NA NA NA NA ...</span>
<span class="co">#&gt;  $ A.P.mc        : logi  NA NA NA NA NA NA ...</span>
<span class="co">#&gt;  $ A.P.mk        : logi  NA NA NA NA NA NA ...</span>
<span class="co">#&gt;  $ A.P.md        : logi  NA NA NA NA NA NA ...</span>
<span class="co">#&gt;  $ A.P.y.mc      : logi  NA NA NA NA NA NA ...</span>
<span class="co">#&gt;  $ A.P.y.mk      : logi  NA NA NA NA NA NA ...</span>
<span class="co">#&gt;  $ A.P.fc        : logi  NA NA NA NA NA NA ...</span>
<span class="co">#&gt;  $ A.P.fk        : logi  NA NA NA NA NA NA ...</span>
<span class="co">#&gt;  $ A.P.y.fc      : logi  NA NA NA NA NA NA ...</span>
<span class="co">#&gt;  $ A.P.y.fk      : logi  NA NA NA NA NA NA ...</span>
<span class="co">#&gt;  $ error1        : logi  NA NA NA NA NA NA ...</span>
<span class="co">#&gt;  $ error2        : logi  NA NA NA NA NA NA ...</span>
<span class="co">#&gt;  $ gamma.i       : num  5 5 5 5 5 5 5 5 5 5 ...</span>
<span class="co">#&gt;  $ c.i           : num  1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ K.bc.i        : num  1 112 223 334 445 556 667 778 889 1000 ...</span>
<span class="co">#&gt;  $ K.wg.i        : num  1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ B.m.tot       : num  0.371 2.702 2.702 2.702 2.702 ...</span>
<span class="co">#&gt;  $ B.m.tot.no.d  : num  0.371 2.702 2.702 2.702 2.702 ...</span>
<span class="co">#&gt;  $ B.f.tot       : num  0.341 2.597 2.597 2.597 2.597 ...</span>
<span class="co">#&gt;  $ sex.ratio     : num  1.09 1.04 1.04 1.04 1.04 ...</span>
<span class="co">#&gt;  $ sex.ratio.no.d: num  1.09 1.04 1.04 1.04 1.04 ...</span>
<span class="co">#&gt;  $ B.tot         : num  0.712 5.3 5.3 5.3 5.3 ...</span>
<span class="co">#&gt;  $ B.tot.no.d    : num  0.712 5.3 5.3 5.3 5.3 ...</span>
<span class="co">#&gt;  $ variable      : int  1 2 3 4 5 6 7 8 9 10 ...</span></code></pre></div>
<p>Each rows is a single run of the model. runFAC_multi() is designed to run the model over multiple combinations of parametrs. A principle output is a 3D surface plot where the x and y axes are two parameters varied between runs of the model and the z (vertical axis) is a state of interest when the model is at equilibrium, such as the equilibirum summer population size.</p>
<p>Plot the 3D surface.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot_Fig28_3.html">plot_Fig28_3</a></span><span class="op">(</span><span class="va">F28_3</span><span class="op">$</span><span class="va">multiFAC.out.df.RM</span><span class="op">)</span></code></pre></div>
<p><img src="e-the_runFAC_multi_command_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
<div id="figure-28-4" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-28-4" class="anchor"></a>Figure 28.4</h3>
<div id="create-parameters" class="section level4">
<h4 class="hasAnchor">
<a href="#create-parameters" class="anchor"></a>Create parameters</h4>
</div>
<div id="create-the-intial-range-of-the-parameters" class="section level4">
<h4 class="hasAnchor">
<a href="#create-the-intial-range-of-the-parameters" class="anchor"></a>Create the intial range of the parameters</h4>
<p>The param_ranges() function can be used to create ranges (minimum and maxiumum) of parameters that can then be subsequently explored using runFAC_multi(). This is the first step, followed by generating sequences of numbers between the min and the max. param_ranges() is set up to take as arguements different scenarios (scenario = … ) or figures (figure = …) defined by Runge and Marra and to produce the combinations of parameters used in that paper. In general one or two parameters are varied and all the others are kept constant.</p>
<p>We can set up the parameters for Figures 28.3 and 28.4 like this</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">F28.3.range</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/param_ranges.html">param_ranges</a></span><span class="op">(</span>figure <span class="op">=</span> <span class="fl">28.3</span><span class="op">)</span>
<span class="va">F28.4.range</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/param_ranges.html">param_ranges</a></span><span class="op">(</span>figure <span class="op">=</span> <span class="fl">28.4</span><span class="op">)</span></code></pre></div>
<p>In this figure K.bc was varied from 100 to 600 and all other parameters kept constant.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">F28.4.range</span><span class="op">)</span>
<span class="co">#&gt;          min   max</span>
<span class="co">#&gt; gamma  5e+00 5e+00</span>
<span class="co">#&gt; co.    1e+00 1e+00</span>
<span class="co">#&gt; K.bc   1e+00 6e+02</span>
<span class="co">#&gt; K.bk   1e+04 1e+04</span>
<span class="co">#&gt; K.wg   9e+02 9e+02</span>
<span class="co">#&gt; S.w.mg 8e-01 8e-01</span></code></pre></div>
</div>
<div id="turn-any-varying-parameters-into-sequence" class="section level4">
<h4 class="hasAnchor">
<a href="#turn-any-varying-parameters-into-sequence" class="anchor"></a>Turn any varying parameters into sequence</h4>
<p>Once the minimum and maxium are set the actual sequence of numbers can be made. This</p>
<p>For Figure 28.4 breding ground carrying capacity is varied from 100 to 600, so we want a vector of numbers, say 100, 200, 300, 400, 500, 600.</p>
<p>For Figure 28.3 breding ground carrying capacity is varied from 1 to 1000, and also winter carrying capacity is varied from 1 to 100.</p>
<p>We make a list the has all the parameters we need</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">F28.3.seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/param_seqs.html">param_seqs</a></span><span class="op">(</span><span class="va">F28.3.range</span><span class="op">)</span>
<span class="va">F28.4.seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/param_seqs.html">param_seqs</a></span><span class="op">(</span><span class="va">F28.4.range</span><span class="op">)</span></code></pre></div>
<p>This is a list</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">is</span><span class="op">(</span><span class="va">F28.4.seq</span><span class="op">)</span>
<span class="co">#&gt; [1] "list"   "vector"</span></code></pre></div>
<p>There is one element for each input parameter</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">F28.4.seq</span><span class="op">)</span>
<span class="co">#&gt; [1] 30</span></code></pre></div>
<p>If a parameter does not need to be varied a single value appears in its slot. Otherwise a vector. For figure 28.4 there is just one parameter that varies</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">F28.4.seq</span><span class="op">)</span>
<span class="co">#&gt; $gamma</span>
<span class="co">#&gt; [1] 5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $co.</span>
<span class="co">#&gt; [1] 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $K.bc</span>
<span class="co">#&gt;  [1]   1.00000  67.55556 134.11111 200.66667 267.22222 333.77778 400.33333</span>
<span class="co">#&gt;  [8] 466.88889 533.44444 600.00000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $K.bk</span>
<span class="co">#&gt; [1] 10000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $K.wg</span>
<span class="co">#&gt; [1] 900</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $S.w.mg</span>
<span class="co">#&gt; [1] 0.8</span></code></pre></div>
<p>For figure 28.3 there are two</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">F28.3.seq</span><span class="op">)</span>
<span class="co">#&gt; $gamma</span>
<span class="co">#&gt; [1] 5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $co.</span>
<span class="co">#&gt; [1] 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $K.bc</span>
<span class="co">#&gt;  [1]    1  112  223  334  445  556  667  778  889 1000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $K.bk</span>
<span class="co">#&gt; [1] 10000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $K.wg</span>
<span class="co">#&gt;  [1]    1  112  223  334  445  556  667  778  889 1000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $S.w.mg</span>
<span class="co">#&gt; [1] 0.8</span></code></pre></div>
</div>
<div id="expand-parameters-into-a-grid" class="section level4">
<h4 class="hasAnchor">
<a href="#expand-parameters-into-a-grid" class="anchor"></a>Expand parameters into a grid</h4>
<p>Once the parameters have been defined a set of all possible parameter combinations needs to be created. This is essentially a grid of all possible value. (The shape isn’t a square grid, but takes its name from the use of R’s expand.grid function)</p>
<p>For figure 28.4 only one parameter is varied.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">F28.4.grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/param_grid.html">param_grid</a></span><span class="op">(</span>param.seqs <span class="op">=</span> <span class="va">F28.4.seq</span><span class="op">)</span>
<span class="co">#&gt; The dimension of the fully expanded dataframe is: </span>
<span class="co">#&gt; 10 by 30</span></code></pre></div>
<p>Figure 28.3 is much larger because two parameters are varied.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">F28.3.grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/param_grid.html">param_grid</a></span><span class="op">(</span>param.seqs <span class="op">=</span> <span class="va">F28.3.seq</span><span class="op">)</span>
<span class="co">#&gt; The dimension of the fully expanded dataframe is: </span>
<span class="co">#&gt; 100 by 30</span></code></pre></div>
<p>The output is a dataframe</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">is</span><span class="op">(</span><span class="va">F28.4.grid</span><span class="op">)</span>
<span class="co">#&gt; [1] "data.frame" "list"       "oldClass"   "vector"</span></code></pre></div>
<p>Each row of the dataframe contains all the parameters needed for a single run of the model.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">F28.4.grid</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>
<span class="co">#&gt;   gamma co.      K.bc  K.bk K.wg S.w.mg S.w.mp S.w.fg S.w.fp S.m.mg</span>
<span class="co">#&gt; 1     5   1   1.00000 10000  900    0.8    0.8    0.8    0.8    0.9</span>
<span class="co">#&gt; 2     5   1  67.55556 10000  900    0.8    0.8    0.8    0.8    0.9</span>
<span class="co">#&gt; 3     5   1 134.11111 10000  900    0.8    0.8    0.8    0.8    0.9</span>
<span class="co">#&gt; 4     5   1 200.66667 10000  900    0.8    0.8    0.8    0.8    0.9</span>
<span class="co">#&gt; 5     5   1 267.22222 10000  900    0.8    0.8    0.8    0.8    0.9</span>
<span class="co">#&gt; 6     5   1 333.77778 10000  900    0.8    0.8    0.8    0.8    0.9</span></code></pre></div>
<p>Each row of data will be fed in the runFAC() function and the model run until an equilibirum is reached.</p>
</div>
<div id="run-multiple-facs-accross-the-parameters" class="section level4">
<h4 class="hasAnchor">
<a href="#run-multiple-facs-accross-the-parameters" class="anchor"></a>Run multiple FACs accross the parameters</h4>
<p>We can run the grid to equilibrium with runFAC_multi().</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">F28.4.FAC</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runFAC_multi.html">runFAC_multi</a></span><span class="op">(</span>param.grid <span class="op">=</span> <span class="va">F28.4.grid</span>,
                             verbose <span class="op">=</span> <span class="cn">F</span>, 
                             eq.tol <span class="op">=</span><span class="fl">6</span>,
                             Ninit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span>, <span class="fl">100</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 57 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 40 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 51 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 57 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 42 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 53 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 58 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 137 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 122 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model at equilibrium after 122 iterations</span></code></pre></div>
</div>
</div>
<div id="plot-figure-28-4" class="section level3">
<h3 class="hasAnchor">
<a href="#plot-figure-28-4" class="anchor"></a>Plot Figure 28.4</h3>
<p>Different kinds of figures require different set up and so there are specific functions for each figure. Figure 28.3 is made with function plot_Fig28_3(). Figure 28.4 has its own function.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_Fig28_4.html">plot_Fig28_4</a></span><span class="op">(</span><span class="va">F28.4.FAC</span><span class="op">$</span><span class="va">multiFAC.out.df.RM</span><span class="op">)</span></code></pre></div>
<p><img src="e-the_runFAC_multi_command_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Nathan Brouwer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
