---
title: "f) Making Runge and Mara Figure 28.4: variation in male territoriality"
author: "Nathan Brouwer"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{f) Making Runge and Mara Figure 28.4: variation in male territoriality}
  %\VignetteEncoding{UTF-8}
  %\VignetteEngine{knitr::rmarkdown}
editor_options: 
  chunk_output_type: console
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```



Load the package
```{r}
library(redstart)
```





plot_Fig28_4
plot_Fig28_4_IBM


## Making Figure 28.4 the easy way

Figure 28.4 can be generated by calling the param_ranges() function with the figure = ... arguement set to 28.4.

```{r}
F28.4 <- param_ranges(figure = 28.4)
```

In this figure all parameters are held constant except K.bc (breeding ground sourrce habitat), which is varied from 1 to 600.
```{r}
head(F28.4)
```

A full sequence of values between these end onts is generated using param_seqs().

```{r}
F28.4.seq <- param_seqs(F28.4)
```

The list create by param_seqs() is turned into a "grid" by param_grid()

```{r}
F28.4.grid <- param_grid(param.seqs = F28.4.seq)
```

We can then run the necessary models by passing the grid tothe "param.grid" arguement of runFAC_multi()

TODO: verbose = F isn't working
```{r}
F28.4.FAC <- runFAC_multi(param.grid = F28.4.grid,
                          verbose = F)
```

The plot plot_Fig28_4() 
```{r}
plot_Fig28_4(runFAC.multi = F28.4.FAC$multiFAC.out.df.RM,
             plot.debug.lines = T)
```


## Make Figure 28.4: Step-by-step instructions

To generate the parameter range by hand we need to specify the range in param_ranges().
```{r}
F28.4.range <- param_ranges(K.bc. = c(0,600))
```

The plot can then be created as above using param_seqs(), param_grid(), runFAC_multi() and plot_Figu28_4().




## Comparing output of redstart to the original 
